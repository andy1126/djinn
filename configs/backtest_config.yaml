# Djinn 回测配置
# 这个文件定义了回测的基本参数

backtest:
  # 基本参数
  initial_capital: 100000  # 初始资金
  commission: 0.001        # 佣金率 (0.1%)
  slippage: 0.0005         # 滑点率 (0.05%)
  tax_rate: 0.001          # 印花税率 (0.1%，A股适用)

  # 数据参数
  data_source: "yahoo_finance"  # 数据源: yahoo_finance, akshare, tushare
  interval: "1d"                # 数据间隔: 1d, 1h, 30m, 15m, 5m, 1m
  adjust: "adj"                 # 价格调整: adj(复权), raw(原始)

  # 时间范围
  start_date: "2020-01-01"
  end_date: "2023-12-31"

  # 缓存配置
  cache_enabled: true
  cache_ttl: 3600  # 缓存过期时间(秒)

  # 风险控制
  risk:
    max_position_size: 0.1      # 最大单仓位比例 (10%)
    stop_loss: 0.1              # 止损比例 (10%)
    take_profit: 0.2            # 止盈比例 (20%)
    max_drawdown: 0.2           # 最大回撤限制 (20%)
    volatility_limit: 0.3       # 波动率限制 (30%)

  # 订单类型
  order_types:
    market_order: true          # 市价单
    limit_order: true           # 限价单
    stop_order: true            # 止损单
    stop_limit_order: false     # 止损限价单

  # 绩效评估
  performance:
    metrics:
      - total_return           # 总收益率
      - annual_return          # 年化收益率
      - sharpe_ratio           # 夏普比率
      - sortino_ratio          # 索提诺比率
      - max_drawdown           # 最大回撤
      - calmar_ratio           # 卡玛比率
      - omega_ratio            # Omega比率
      - win_rate               # 胜率
      - profit_factor          # 盈利因子
      - recovery_factor        # 恢复因子

  # 报告生成
  report:
    format: "html"             # 报告格式: html, pdf, markdown
    save_path: "./reports"
    include_charts: true
    include_trades: true
    include_metrics: true

# 策略配置
strategy:
  name: "MovingAverageCrossover"
  parameters:
    fast_period: 10
    slow_period: 30
    signal_period: 9

  # 仓位管理
  position_sizing:
    method: "fixed_fractional"  # 固定分数, fixed_units, percent_risk
    risk_per_trade: 0.02        # 每笔交易风险 (2%)
    max_risk: 0.1               # 最大总风险 (10%)

# 投资组合配置 (可选)
portfolio:
  enabled: false
  rebalance_frequency: "monthly"  # 再平衡频率: daily, weekly, monthly, quarterly
  allocation_method: "equal_weight"  # 分配方法: equal_weight, market_cap, risk_parity

# 优化配置 (可选)
optimization:
  enabled: false
  method: "grid_search"        # 优化方法: grid_search, random_search, bayesian
  param_space:                 # 参数空间
    fast_period: [5, 10, 20, 30]
    slow_period: [20, 30, 50, 100]
  metric: "sharpe_ratio"       # 优化目标指标
  n_trials: 100                # 试验次数